<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D模型文件列表 - papayalove</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #2c3e50; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .file-list { list-style: none; padding: 0; }
        .file-item { padding: 8px 0; border-bottom: 1px dashed #eee; }
        .file-link { color: #0366d6; text-decoration: none; }
        .file-link:hover { text-decoration: underline; }
        .file-size { color: #586069; font-size: 0.9em; margin-left: 10px; }
        .loading { color: #6a737d; }
    </style>
</head>
<body>
    <h1>3D模型文件列表</h1>
    <p>当前目录: <code>https://papayalove.github.io/3dmodels/</code></p>
    <ul id="fileList" class="file-list">
        <li class="loading">正在加载文件列表...</li>
    </ul>

    <script>
        // GitHub Pages会自动为目录生成JSON索引（需开启自动索引）
        async function loadDirectory() {
            const baseUrl = 'https://papayalove.github.io/3dmodels/';
            const fileList = document.getElementById('fileList');
            
            try {
                // 尝试获取目录索引
                const response = await fetch(baseUrl, {
                    headers: { 'Accept': 'application/json' } // 请求JSON格式
                });
                
                if (!response.ok) {
                    throw new Error('目录索引不可用');
                }
                
                const data = await response.json();
                renderFileList(data, baseUrl);
                
            } catch (error) {
                // 如果自动索引不可用，改为硬编码文件列表
                console.warn('无法获取自动索引:', error);
                fileList.innerHTML = `
                    <li><a href="scene.gltf" class="file-link">scene.gltf</a></li>
                    <li><a href="scene.bin" class="file-link">scene.bin</a></li>
                    <li><a href="textures/" class="file-link">textures/</a></li>
                `;
            }
        }

        // 渲染文件列表
        function renderFileList(files, baseUrl) {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            files.forEach(item => {
                const li = document.createElement('li');
                li.className = 'file-item';
                
                const link = document.createElement('a');
                link.href = baseUrl + item.name;
                link.className = 'file-link';
                link.textContent = item.name;
                
                if (item.type === 'dir') {
                    link.textContent += '/';
                    link.style.fontWeight = 'bold';
                }
                
                li.appendChild(link);
                
                if (item.size) {
                    const sizeSpan = document.createElement('span');
                    sizeSpan.className = 'file-size';
                    sizeSpan.textContent = formatFileSize(item.size);
                    li.appendChild(sizeSpan);
                }
                
                fileList.appendChild(li);
            });
        }

        // 格式化文件大小
        function formatFileSize(bytes) {
            if (!bytes) return '';
            if (bytes < 1024) return bytes + ' B';
            const units = ['KB', 'MB', 'GB'];
            let size = bytes;
            let i = 0;
            while (size >= 1024 && i < units.length) {
                size /= 1024;
                i++;
            }
            return size.toFixed(1) + ' ' + units[i-1];
        }

        // 页面加载时执行
        window.addEventListener('DOMContentLoaded', loadDirectory);
    </script>
</body>
</html>
